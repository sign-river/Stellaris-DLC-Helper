# config.json 配置说明

本文档说明 `config.json` 中各个配置项的作用和使用方法。

## 基本配置

### version
- **类型**: String
- **说明**: 程序版本号
- **示例**: `"1.0.4"`
- **注意**: 由程序自动管理，建议不要手动修改

### stellaris_app_id
- **类型**: String
- **说明**: Stellaris在Steam中的App ID
- **默认值**: `"281990"`
- **注意**: 固定值，不应修改

## settings（用户设置）

### default_source
- **类型**: String
- **说明**: 默认下载源
- **可选值**: `"gitlink"`
- **默认值**: `"gitlink"`

### dismissed_announcement_version
- **类型**: String
- **说明**: 已标记"不再显示"的公告版本号
- **默认值**: `""` (空字符串)
- **作用**: 
  - 当用户在公告对话框中勾选"本版本不再显示此公告"时，会自动保存当前版本号到此字段
  - 程序启动时会检查此字段，如果与当前版本号相同，则不再自动弹出公告
  - 程序更新到新版本时，此字段会自动失效（因为版本号不匹配）
- **手动设置**: 
  - 如果想重新显示当前版本的公告，将此字段设为空字符串 `""`
  - 如果想禁用当前版本的公告，将此字段设为当前版本号（如 `"1.0.4"`）
- **示例**: 
  ```json
  "dismissed_announcement_version": ""        // 显示公告
  "dismissed_announcement_version": "1.0.4"   // 不显示v1.0.4的公告
  ```

## server（服务器配置）

### update_url_base
- **类型**: String
- **说明**: 更新文件的基础URL
- **默认值**: `"https://gitlink.org.cn/signriver/file-warehouse/releases/download/v/"`

### appinfo_url
- **类型**: String
- **说明**: 游戏应用信息URL
- **默认值**: `"https://gitlink.org.cn/signriver/file-warehouse/releases/download/ste/stellaris_appinfo.json"`

### sources
- **类型**: Array
- **说明**: DLC下载源列表
- **字段**:
  - `name`: 源名称
  - `url`: 下载基础URL
  - `priority`: 优先级（暂未使用）
  - `enabled`: 是否启用
  - `format`: 格式类型
  - `mapping_file`: 映射文件名
  - `test_url`: 测速URL

### timeout
- **类型**: Number
- **说明**: 网络请求超时时间（秒）
- **默认值**: `30`

## network（网络配置）

### chunk_size
- **类型**: Number
- **说明**: 下载块大小（字节）
- **默认值**: `8192`

### retry_times
- **类型**: Number
- **说明**: 下载失败重试次数
- **默认值**: `3`

## cache（缓存配置）

### dir_name
- **类型**: String
- **说明**: 缓存目录名称
- **默认值**: `"Stellaris_DLC_Cache"`

### dlc_subdir
- **类型**: String
- **说明**: DLC缓存子目录
- **默认值**: `"dlc"`

### log_subdir
- **类型**: String
- **说明**: 日志子目录
- **默认值**: `"operation_logs"`

## fonts（字体配置）

配置程序界面使用的字体样式。每个字体项是一个数组：`[字体名称, 字体大小, 字体样式]`

- **font1**: 大号粗体标题 `["Microsoft YaHei UI", 20, "bold"]`
- **font2**: 中号粗体标题 `["Microsoft YaHei UI", 16, "bold"]`
- **font3**: 普通正文 `["Microsoft YaHei UI", 12]`
- **font4**: 小号正文 `["Microsoft YaHei UI", 10]`

## 常见问题

### Q: 如何禁用公告弹窗？
A: 将 `settings.dismissed_announcement_version` 设为当前版本号（如 `"1.0.4"`），或在公告对话框中勾选"本版本不再显示此公告"。

### Q: 如何重新显示公告？
A: 将 `settings.dismissed_announcement_version` 设为空字符串 `""`。

### Q: 为什么更新后公告又弹出了？
A: 这是正常行为。每个新版本都有自己的公告，只有当 `dismissed_announcement_version` 与当前版本号完全一致时才会隐藏公告。

### Q: 修改配置后需要重启程序吗？
A: 是的，大部分配置修改需要重启程序才能生效。
