# 平台兼容性说明

## 支持的操作系统

本工具**仅支持 Windows 操作系统**（Windows 7/8/10/11 64位）。

## 为什么只支持 Windows？

本工具目前仅实现了 Windows 平台的补丁应用功能：

### 主要原因
1. **补丁文件**：项目中仅包含 Windows 版本的 CreamAPI 补丁
2. **补丁逻辑**：仅实现了 Windows 平台的补丁安装和管理逻辑
3. **路径检测**：使用 Windows 注册表检测 Steam 和游戏路径

### 技术细节
- **补丁位置**：`patches/` 目录下的 CreamAPI 补丁为 Windows 专用
- **安装逻辑**：`src/core/patch_manager.py` 中的实现针对 Windows 环境
- **路径检测**：`src/utils/steam_utils.py` 使用 Windows 注册表（winreg）

## 在非 Windows 系统上的行为

如果在 macOS 或 Linux 系统上运行本程序，会出现以下提示：

### 控制台提示
```
============================================================
错误: 此程序仅支持 Windows 操作系统
============================================================
检测到当前系统: Darwin 21.0.0  (或 Linux 5.x.x)

本工具目前仅实现了 Windows 平台的补丁功能。

如需支持其他系统，请在项目 GitHub 页面提交 Issue 或贡献代码:
https://github.com/sign-river/Stellaris-DLC-Helper/issues
============================================================
```

### 图形界面提示
程序会尝试显示一个错误对话框，提示用户当前系统不受支持。

## 跨平台支持的可能性

理论上可以实现跨平台支持，需要完成以下工作：

1. **添加其他平台的补丁文件**
   - 获取 macOS/Linux 版本的 CreamAPI 或等效补丁
   - 添加到 `patches/` 目录

2. **实现对应的补丁逻辑**
   - 在 `patch_manager.py` 中添加 macOS/Linux 的补丁安装逻辑
   - 适配不同系统的文件权限和路径处理

3. **实现跨平台路径检测**
   - macOS: `~/Library/Application Support/Steam/`
   - Linux: `~/.steam/steam/` 或 `~/.local/share/Steam/`

4. **测试和验证**
   - 在对应平台上测试补丁功能
   - 确保游戏正常运行

## 对开发者的建议

如果您想为项目添加跨平台支持，欢迎：

1. 在 [GitHub Issues](https://github.com/sign-river/Stellaris-DLC-Helper/issues) 中提出需求
2. Fork 项目并实现对应平台的功能
3. 提交 Pull Request 贡献代码

### 参考实现
- 参考 `src/core/patch_manager.py` 中的 Windows 实现
- 参考 `src/utils/steam_utils.py` 中的路径检测逻辑

## 相关文件

- `main.py` - 主入口，操作系统检查
- `src/core/patch_manager.py` - 补丁管理（仅 Windows）
- `src/utils/steam_utils.py` - Steam 路径检测（使用 winreg）
- `patches/` - 补丁文件目录（仅 Windows 版本）
- `src/utils/steam_utils.py` - Steam 工具，使用 winreg
- `tools/updater_helper.py` - 更新助手，使用 ctypes
- `README.md` - 系统要求说明

## 更新日志

- **2025-12-02**：添加操作系统检查和友好的错误提示
- 在非 Windows 系统启动时显示清晰的错误信息
- 在 README.md 中明确标注仅支持 Windows
